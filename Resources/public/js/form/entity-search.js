define(["jquery","routing"],function(a,b){"use strict";return a.fn.entitySearchWidget=function(c){return c=a.extend({limit:8},c),this.each(function(){var d=a(this),e=b.generate(d.data("search")),f=(b.generate(d.data("find")),1==d.data("clear"));d.select2({placeholder:"Rechercher ...",allowClear:f,minimumInputLength:3,ajax:{delay:300,url:e,dataType:"json",data:function(a){return{search:a.term,page:a.page,limit:c.limit}},processResults:function(a,b){return console.log(a),b.page=b.page||1,{results:a.items,pagination:{more:b.page*c.limit<a.total_count}}},escapeMarkup:function(a){return a}}})}),this},{init:function(a){a.entitySearchWidget()}}});