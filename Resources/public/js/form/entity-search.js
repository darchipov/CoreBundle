define(["jquery","routing"],function(a,b){"use strict";return a.fn.entitySearchWidget=function(c){return c=a.extend({limit:8},c),this.each(function(){var d=a(this),e=new Function("data",d.data("format"));d.select2({placeholder:"Rechercher ...",allowClear:1==d.data("clear"),minimumInputLength:3,templateResult:e,ajax:{delay:300,url:b.generate(d.data("search")),dataType:"json",data:function(a){return{query:a.term,page:a.page,limit:c.limit}},processResults:function(a,b){return b.page=b.page||1,{results:a.results,pagination:{more:b.page*c.limit<a.total_count}}},escapeMarkup:function(a){return a}}})}),this},{init:function(a){a.entitySearchWidget()}}});